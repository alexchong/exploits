#!/usr/bin/sh
# Description : 'python3 -m http.server' script wrapper

# Function to display usage
usage() {
  echo "Description : 'python3 -m http.server' script wrapper"
  echo "Usage: $0 [port] [path]"
  exit 0
}

# Set default values
PORT=80
PATH_TO_SERVE=$(pwd)
INTERFACE="tun0" # Default interface

# Parse arguments
while [ $# -gt 0 ]; do
  case "$1" in
    -h)
      usage
      ;;
    *)
      if [ -z "$PORT_SET" ]; then
        PORT=$1
        PORT_SET=true
      elif [ -z "$PATH_SET" ]; then
        PATH_TO_SERVE=$1
        PATH_SET=true
      else
        usage
      fi
      shift
      ;;
  esac
done

echo "===== Starting python3 -m http.server $PORT"
echo "=== IP: $(ip a show $INTERFACE | grep inet | grep -v inet6)"
echo "=== Serving Path: $PATH_TO_SERVE"

# Change to the specified directory
cd "$PATH_TO_SERVE" || { echo "Invalid path: $PATH_TO_SERVE"; exit 1; }

python3 -m http.server $PORT
